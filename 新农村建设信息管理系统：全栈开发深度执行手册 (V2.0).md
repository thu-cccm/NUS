# 新农村建设信息管理系统 - 需求规格说明书 (PRD)

**文档版本**：V1.0
**基座技术**：Maple-Boot (SpringBoot 2.7 + Vue3 + Mybatis-Plus)
**核心目标**：打造一个集“村务管理、便民服务、数据可视化”于一体的综合治理平台。
**数据来源**：本系统为演示系统，无真实数据来源，所有数据需要自行根据实际创建

------



## 一、 用户角色定义 (对应原需求1, 10)

本系统严格执行 **RBAC (Role-Based Access Control)** 权限模型，分为两类核心用户：

1. **村务管理员 (Admin/村干部)**
   - **权限**：拥有全系统最高权限，负责数据录入、审核申请、发布公告、查看统计报表。
   - **特殊能力**：可查看脱敏前的完整身份证号、电话号码；可驳回或通过村民的申请。
2. **村民 (Villager)**
   - **权限**：仅拥有“查”和“申请”的权限。
   - **数据隔离**：只能查看**自己及家庭成员**的档案信息，只能查看**自己提交**的申请状态。
   - **交互**：可参与投票、发表留言、查看公开资讯。

------



## 二、 核心功能模块拆解

### 模块 1：数字乡村档案中心

此模块是系统的“数据基座”，必须支持大数据量的存储与检索。

- **1.1 村民人口档案 (核心)**
  - **功能**：实现村民信息的数字化建档。
  - **字段细化**：除了姓名、身份证、性别、电话外，需增加 政治面貌 (党员/群众)、是否贫困户、文化程度、健康状况。
  - **家庭关系**：支持“户主”与“家庭成员”的绑定关系（通过户号关联）。
- **1.2 土地资源台账**
  - **功能**：管理宅基地、承包地、林地信息。
  - **关联**：每块土地必须关联到一个具体的 户主。

### 模块 2：一站式村务办事大厅

此模块是系统的“业务引擎”，核心是状态机流转。

- **2.1 事务申请 (前台)**
  - **功能**：村民发起业务申请。
  - **业务类型**：预设 4 类高频业务：户口变动、低保申请、宅基地翻建、农机补贴。
  - **附件上传**：必须支持上传身份证照片、户口本照片（对接对象存储或本地文件服务）。
- **2.2 审批工作台 (后台)**
  - **功能**：管理员对申请进行审批。
  - **流程状态机**：待审核 -> 审核通过/审核驳回 -> 归档。
  - **驳回机制**：驳回时必须填写“驳回原因”，村民登陆端可见且可重新提交。
  - 延伸功能：可视化审批进度条
    - 在详情页顶部展示步骤条（Step Bar），清晰展示当前处于哪个环节（提交 -> 村委初审 -> 公示 -> 完成）。

### 模块 3：村务公开与民主治理

此模块增强村民参与感。

- **3.1 通知公告 (CMS轻量版)**
  - **功能**：发布政策文件、停水停电通知、村务财务公示。
  - **特性**：支持置顶、富文本编辑。
- **3.2 民主议事厅 (记名投票)**
  - **功能**：村委发起议题（如“是否修缮村东道路”），村民记名投票（赞成/反对/弃权）。
  - **限制**：每个账号对每个议题限投一票，结果统计并图表化展示。
- **3.3 村民互动墙**
  - **功能**：简易版留言板。
  - **逻辑**：村民留言 -> 管理员后台回复 -> 前端显示“官方回复”。支持管理员删除恶意留言。

### 模块 4：公共服务资源库

- **4.1 便民服务黄页**
  - **功能**：结构化展示医疗、教育、就业信息。
  - **分类**：
    - 医疗卫生：村卫生室电话、坐诊医生排班。
    - 文化教育：周边小学招生政策、农家书屋开放时间。
    - 就业招聘：周边工厂招工信息发布。

### 模块 5：驾驶舱与数据决策

此模块是系统的“门面”，用于首页展示。

- **5.1 乡村治理驾驶舱 (Dashboard)**
  - **数据指标**：总人口、党员数、贫困户数、本月待办事项。
  - **图表分析 (ECharts)**：
    - **人口结构图**：各年龄段/性别比例（饼图）。
    - **土地利用图**：耕地、林地、宅基地面积对比（柱状图）。
    - **办事效率图**：近6个月申请数量与办结率趋势（折线图）。

------



## 三、 非功能性需求与支撑模块 

### 模块 6：安全与运维支撑

- **6.1 数据安全与脱敏 (原需求9)**
  - **功能**：在列表展示时，对敏感字段进行掩码处理。
  - **规则**：身份证号显示为 4201**********1234，手机号显示为 138****5678。管理员点击“查看原件”按钮时才请求完整数据。
- **6.2 操作日志审计**
  - **功能**：记录所有敏感操作（如删除村民、审核驳回）。
  - **内容**：操作人、操作时间、操作内容、旧值/新值。
- **6.3 网格化管理**
  - **功能**：将村民按“组”进行划分（如一至五组）。
  - **逻辑**：每个村干部账号可以绑定一个“管辖网格”，在后台筛选数据时，默认只看自己网格内的村民（也可查看全部），实现精细化管理。



## 前端交互设计规范 (UI/UX Code)

**设计目标**：简洁、现代、易用。拒绝拥挤的表格和杂乱的配色。
**技术栈**：Vue 3 + Element Plus + ECharts

### 1. 整体布局与配色

- **主题色 (Primary Color)**：使用 **#409EFF (科技蓝)** 作为主操作色，配合 **#67C23A (生机绿)** 作为辅助色（用于状态“成功”、“通过”），体现“数字乡村”概念。
- **布局模式**：采用 Left-Right 布局。左侧为可折叠的深色菜单栏，右侧为白色内容区。内容区必须包含 **Breadcrumb (面包屑导航)**。
- **卡片式设计**：所有内容块（表格、表单、图表）必须包裹在 <el-card> 中，设置 shadow="hover"，背景色纯白，与灰色底色 (#f0f2f5) 形成层次感。

### 2. 列表页设计标准 (List View)

- **搜索栏**：位于表格上方。输入框统一使用 placeholder="请输入..."，搜索按钮使用 icon="Search"。
- **操作栏**：位于表格右上方，包含“新增”、“批量删除”、“导出”按钮。
  - 新增按钮：**蓝色实心** (type="primary")。
  - 删除按钮：**红色空心** (type="danger" plain)。
- **表格 (Table)**：
  - **斑马纹**：开启 stripe 属性。
  - **状态列**：严禁直接显示 0/1。必须使用 <el-tag> 组件。
    - 待审核/进行中 -> <el-tag type="warning"> (橙色)
    - 已通过/正常/完成 -> <el-tag type="success"> (绿色)
    - 已驳回/异常 -> <el-tag type="danger"> (红色)
  - **操作列**：使用 Text Button (type="primary" link)，如 [编辑] [详情] [删除]，避免按钮过多撑爆表格。
- **分页**：必须固定在表格右下方，包含 Total 显示。

### 3. 表单与交互设计 (Form & Interaction)

- **弹窗交互**：
  - 简单的“新增/编辑”使用 <el-dialog>，宽度 500px 至 700px。
  - 复杂的“详情查看”使用 <el-drawer> (抽屉)，从右侧滑出，宽度 40%。
- **删除确认**：所有删除操作必须触发 <el-popconfirm> 或 ElMessageBox.confirm，防止误触。
- **表单验证**：必填项必须有红色星号，且在提交时触发 rules 校验，未通过校验禁止提交后台。

------



## 第二部分：全功能模块详细拆解 (11大模块)

### 模块 1：人口与户籍档案管理 (基础核心)

- **业务场景**：不仅仅是个人，核心是**“户”**的概念。
- **功能细节**：
  1. **户籍分组**：列表展示时，支持按“户”折叠或展开。第一层显示户主，点击展开显示家庭成员。
  2. **特殊人群标记**：在录入时，提供多选框标记标签：[留守儿童] [空巢老人] [退役军人] [残疾人]。列表页直接展示这些彩色标签。
  3. **人口迁入/迁出**：提供一个“迁出”按钮，点击后不物理删除数据，而是将状态改为“迁出”，并记录迁出地和时间。

### 模块 2：土地与宅基地资源 (基础核心)

- **业务场景**：确权管理，解决“地是谁的”问题。
- **功能细节**：
  1. **地块地图概览**：在详情页中，可支持上传地块的“红线图”或航拍图（由用户上传）。
  2. **流转记录**：除了基础信息，下方需增加一个 el-timeline (时间轴)，记录这块地历年的承包权变更记录（如：2020年张三承包 -> 2023年流转给李四）。

### 模块 3：农业生产管理

- **设计初衷**：新农村离不开农业，管理种植计划与补贴。
- **功能细节**：
  1. **种植计划申报**：村民申报今年种植作物（如：水稻 10亩，玉米 5亩）。
  2. **农资发放记录**：管理员记录化肥、种子、农药的发放情况。字段：领取人、物资名称、数量、发放日期。
  3. **产值预估**：系统根据（种植面积 × 预设亩产 × 市场单价）自动计算预计产值，并在首页展示全村农业总产值。

### 模块 4：基础设施与工程项目 

- **设计初衷**：管理修路、水利、路灯等村级工程。
- **功能细节**：
  1. **项目全生命周期**：包含 立项 -> 施工中 -> 验收 -> 维保 四个状态。
  2. **进度可视化**：在列表页使用 <el-progress> 条展示工程进度（0% - 100%）。
  3. **设施报修**：村民可提交“路灯坏了”、“井盖丢了”的报修申请，管理员派单维修，状态变为“维修中”。

### 模块 5：党建引领与党员管理

- **设计初衷**：中国特色的农村管理核心是党建。
- **功能细节**：
  1. **党员红名册**：独立于普通村民的党员列表，展示入党时间、所属党小组。
  2. **三会一课记录**：记录支部大会、党小组会、党课的开展情况。字段：会议主题、时间、地点、参会人员、会议照片（图片墙展示）。
  3. **党员积分制**：记录党员参与志愿服务的积分，积分高者在首页光荣榜展示。

### 模块 6：综治网格与平安乡村

- **设计初衷**：解决邻里纠纷、治安巡逻。
- **功能细节**：
  1. **矛盾调解卷宗**：记录邻里纠纷的调解过程。字段：纠纷双方、矛盾类型（土地/邻里/家庭）、调解结果（成功/失败）、现场笔录。
  2. **安全隐患排查**：网格员上传隐患（如：危房、池塘无护栏），状态流转：待整改 -> 已整改。
  3. **重点人员帮教**：针对矫正人员的定期走访记录。

### 模块 7：集体资产与财务公开 

- **设计初衷**：管理村集体的拖拉机、活动室、商铺等资产。
- **功能细节**：
  1. **资产台账**：列表展示资产名称、原值、购买日期、保管人。
  2. **租赁合同管理**：针对出租的集体商铺/鱼塘，记录合同起止日期。
     - **高亮预警**：当合同距离到期少于 30 天时，在该行数据标红显示“即将到期”。
  3. **财务流水公示**：简单的收支记录表（收入/支出），支持按月统计，生成“月度财务报表”供村民查看。

### 模块 8：一站式办事大厅 (在线审批)

- **功能升级**：
  1. **多级审批流**：对于“低保申请”等敏感事项，设计“村委初审 -> 街道复核”的逻辑（虽然系统只有村级，但在状态栏显示‘等待上级复核’会显得业务很真实）。
  2. **电子印章演示**：审批通过后，在详情页生成一个带有“XX村委会”红色印章背景的电子回单（CSS实现即可）。

### 模块 9：民主议事与投票

- **功能升级**：
  1. **实名/匿名切换**：发布投票时，管理员可选择是否开启“匿名投票”。
  2. **结果实时饼图**：投票详情页右侧，实时显示 ECharts 饼图（赞成 vs 反对），投票后无需刷新页面，图表动态更新（前端模拟数据变化）。

### 模块 10：公共服务与通知

- **功能升级**：
  1. **精准推送**：发布通知时，可选择推送对象：全村、仅党员、仅贫困户。
  2. **政策解读库**：不仅仅是通知，还是一个知识库。支持上传 PDF 文件，村民点击可直接在浏览器预览（使用 PDF.js）。

### 模块 11：驾驶舱 (Dashboard)

- **功能升级**：
  1. **四个核心维度**：人口概况、土地利用、产业经济、民生服务。
  2. **动态天气组件**：右上角调用免费的天气 API，显示村庄当地的实时天气，增加系统的“鲜活感”。

------



## 第三部分：给开发者的执行Tips

1. **关于“空状态”**：
   - 所有列表在无数据时，不要只留白。使用 <el-empty description="暂无相关记录"> 组件占位，提升体验。
2. **关于“加载中”**：
   - 所有网络请求期间（如点击查询、点击提交），按钮必须进入 loading 状态，表格必须显示 v-loading 遮罩，防止用户重复点击。
3. **数据库命名规范**：
   - 新模块表名建议：
     - vms_agriculture_plan (农业计划)
     - vms_project (工程项目)
     - vms_party_member (党员表)
     - vms_dispute (矛盾纠纷)
     - vms_asset (集体资产)

# 为了避免上述内容的模糊不清，我专门为前端和后端的开发写了执行文档

# 文档一：后端开发架构与逻辑规范书 (Backend PRD)

**目标读者**：资深 Java 后端工程师
**核心任务**：数据库建模、RESTful 接口开发、业务逻辑实现、数据权限控制。
**技术约束**：SpringBoot 2.7, Mybatis-Plus, MySQL 8.0, Lombok。

## 1. 总体设计原则

- **统一响应体**：所有接口必须返回 AjaxResult (或基座自带的 R 对象)，禁止直接返回实体类。
- **异常处理**：使用 @RestControllerAdvice 统一处理业务异常，抛出 ServiceException。
- **数据权限 (Data Scope)**：核心逻辑。
  - **Admin角色**：查询时无额外条件。
  - **Villager角色**：查询 Resident, Application, Land 等个人数据时，拦截器或 Service 层必须强制追加 WHERE create_by = currentUserId 或 resident_id = currentUserId。

## 2. 数据库建模指令 (Schema Design)

请在数据库中创建以下 **11 张核心业务表**（需包含 create_time, update_time, create_by, deleted 等基座标准字段）：

### A. 基础档案域

1. **人口表 (vms_resident)**
   - 核心字段：real_name, id_card (唯一索引), phone, gender, birthday, address, group_id (村组ID), politics_status(党员/团员/群众), is_poverty (0否1是), tags (JSON字段, 存标签如["低保","残疾"]), family_id (户号).
2. **土地资源表 (vms_land)**
   - 核心字段：resident_id (关联人口), land_code (地块编码), area (面积), land_type (1耕地 2宅基地 3林地), geo_json (预留存坐标), contract_file (合同图片URL).
3. **集体资产表 (vms_asset)** 
   - 核心字段：asset_name, asset_type (农机/房产/设施), original_value (原值), purchase_date, keeper (保管人), status(正常/维修/报废).

### B. 业务流转域

1. **事务申请表 (vms_application)**
   - 核心字段：apply_type (字典: 户口/建房/补助), content (文本), attachments (多图URL逗号分隔), current_audit_role (当前审核角色), status (0待审 1通过 2驳回 9撤销), audit_comment (审核意见).
2. **矛盾纠纷调解表 (vms_dispute)** 
   - 核心字段：party_a (当事人A), party_b, conflict_type (土地/邻里/家庭), happen_time, mediator (调解员), result_content, status (0待处理 1处理中 2已结案).
3. **工程项目表 (vms_project)** 
   - 核心字段：project_name, budget (预算), contractor (施工方), start_date, end_date, progress (0-100整数), status(0规划 1施工 2验收).

### C. 生产与党建域

1. **农业生产计划表 (vms_agriculture)** 
   - 核心字段：year (年份), crop_name, total_area (全村种植面积), estimated_output (预估产量), market_price, resident_id (申报人).
2. **党建活动表 (vms_party_activity)** 
   - 核心字段：title, type (三会一课/主题党日), hold_time, location, participants (参会人员名单), summary (会议纪要).

### D. 互动与通知域

1. **通知公告表 (vms_notice)**
   - 核心字段：title, content (RichText), type (通知/公示/政策), target_group (全员/党员/贫困户), is_top (置顶).
2. **民主投票表 (vms_vote)**
   - 核心字段：subject, description, start_time, end_time, is_anonymous (匿名), agree_count, oppose_count.
   - *注：需配合 vms_vote_record 记录防止刷票。*
3. **留言互动表 (vms_feedback)**
   - 核心字段：content, is_public (是否公开), reply_content (官方回复), reply_time.

## 3. 核心业务接口逻辑 (Service Layer)

### 3.1 审批状态机 (Approval Workflow)

- **场景**：处理 vms_application。
- **接口**：POST /audit
- **逻辑**：
  1. 校验当前用户是否为 Admin。
  2. 接收 id, action (pass/reject), comment。
  3. 如果 pass，状态置为 1；如果 reject，状态置为 2。
  4. **关键**：更新 audit_time 和 auditor_name 字段，保留审计痕迹。

### 3.2 首页数据聚合 (Dashboard Aggregation)

- **接口**：GET /dashboard/stats

- **逻辑**：不要前端调10个接口，后端聚合一次返回一个 VO (Value Object)：

  code Java

  ```
  class DashboardVO {
      long residentCount; // 总人口
      long partyMemberCount; // 党员数
      double totalLandArea; // 总耕地
      List<Map<String, Object>> applyTrend; // 近6个月申请趋势
      List<Map<String, Object>> cropDistribution; // 作物分布
  }
  ```

### 3.3 导出功能 (Excel Export)

- **场景**：人口档案、财务报表。
- **技术**：使用 EasyExcel。
- **逻辑**：实现 GET /resident/export，支持根据搜索条件导出 Excel 文件，表头需包含中文描述。

------



# 文档二：前端开发交互与视觉规范书 (Frontend PRD)

**目标读者**：资深 Vue 前端工程师
**核心任务**：组件开发、页面交互、数据可视化、Mock数据填充。
**技术约束**：Vue 3 (Composition API), Element Plus, ECharts 5, Axios。

## 1. 视觉与交互规范 (UI/UX Code)

- **色系定义**：
  - Primary: #16A34A (乡村绿 - 用于主按钮、激活状态)
  - Warning: #F59E0B (丰收黄 - 用于待审核、预警)
  - Danger: #DC2626 (用于删除、驳回)
- **布局结构**：
  - 侧边栏：深色背景，Logo区域替换为“新农村”图标。
  - 内容区：Padding: 20px，所有业务内容包裹在 <el-card shadow="hover"> 中。
- **表格交互**：
  - 必须开启 border 和 stripe。
  - 操作列按钮统一使用 <el-button link type="primary">。

## 2. 页面开发详细清单 (Page Specs)

请按以下模块开发页面，每个模块对应路由 /vms/xxx：

### 模块 1：数字驾驶舱 (Dashboard)

- **组件要求**：
  - **顶栏**：4个 InfoCard 组件，展示总人口、党员、集体资金（带 ¥ 符号）、待办事项。
  - **中栏**：
    - 左侧：ECharts 饼图（人口结构：老人/劳动力/儿童）。
    - 右侧：ECharts 柱状图（各组耕地面积对比）。
  - **底栏**：滚动播放的“最新公告”列表。
- **数据源**：调用 /dashboard/stats，加载时显示骨架屏 (Skeleton)。

### 模块 2：人口档案 (Resident)

- **高级搜索**：顶部折叠面板，支持按 姓名、身份证、政治面貌、是否贫困 筛选。
- **标签渲染**：is_poverty=1 时，姓名旁显示 <el-tag type="danger" effect="dark">贫困户</el-tag>。
- **详情抽屉**：点击详情，从右侧弹出 el-drawer，使用 el-descriptions 组件展示户主及家庭成员信息（类似户口本样式）。

### 模块 3：事务审批 (Application)

- **Tab切换**：顶部固定 Tabs: 全部 | 待我审核 | 我发起的。
- **流程进度条**：在详情页顶部放置 el-steps：
  - Step 1: 提交申请 (时间)
  - Step 2: 村委审核 (当前状态，显示审核员头像)
  - Step 3: 办结
- **图片预览**：附件区域使用 el-image，开启 preview-src-list 大图预览功能。

### 模块 4：土地与资产 (Land & Asset)

- **证书生成**：在土地详情页，放置一个“打印证书”按钮。点击后弹窗显示一个 CSS 画的证书样式（带红框、国徽背景），调用浏览器 window.print()。
- **资产预警**：资产列表中的“状态”列，如果是“报废”显示灰色，“维修中”显示橙色。

### 模块 5：工程项目 (Project)

- **进度编辑**：
  - 列表页显示 <el-progress :percentage="row.progress">。
  - 编辑弹窗中，使用 Slider 滑块拖动调整进度 0-100。

### 模块 6：党建与活动 (Party)

- **照片墙**：活动记录详情页，使用 Grid 布局展示活动现场照片，支持点击放大。
- **红名单**：党员列表页，将头部背景渲染为淡红色，强调党建氛围。

### 模块 7：矛盾调解 (Dispute)

- **卷宗样式**：详情页模拟“派出所笔录”样式，左右分栏，左边是纠纷描述，右边是调解过程记录（Timeline 时间轴）。

## 3. 前端特殊任务 (Mock & Demo)

由于是演示项目，请在前端层做以下处理（如果后端数据不足）：

1. **图片兜底**：所有涉及用户头像、活动照片的地方，如果图片加载失败，默认显示一张预设的灰色占位图或随机矢量图。
2. **空状态美化**：表格无数据时，使用 el-empty 组件，文案：“暂无相关记录，请点击右上角新增”。
3. **大屏模式**：在首页右上角增加一个“全屏展示”按钮，点击后隐藏侧边栏和顶栏，仅展示 Dashboard，适合答辩演示。
